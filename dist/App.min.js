!(function(){"use strict";function n(){}function e(){this.map=new n}function t(n,e){x(n),e.removeChild(n.$n)}function a(n,e,a){for(;a<n.length;)t(n[a++],e)}function r(n,e){for(var t=0;t<n.length;)x(n[t++]);e.textContent=""}function c(n,e){return n.$s===e.$s&&(e.$s.u(e,n),!0)}function o(n,e,t,a){null===a?u(n,e,t):i(n,e,t,a)}function i(n,e,t,a){for(;t<e.length;)n.insertBefore((e[t]=y(e[t])).$n,a),++t}function u(n,e,t){for(;t<e.length;)n.appendChild((e[t]=y(e[t])).$n),++t}function s(n,e,t){var a=document.createDocumentFragment(),r=O(n,a,e);return E(t,a),r}function d(n,e,t,r){for(var c=0;c<e.length&&c<t.length;c++)e[c]=A(t[c],e[c]);c<e.length?o(n,e,c,r):a(t,n,c)}function l(n,e,t){t.length?e.length?d(n,e,t,null):r(t,n):u(n,e,0)}function f(n,e,t,c){return n instanceof Array?(t?l(e,n,c):d(e.parentNode,n,c,e),e):t?(r(c,e),O(!0,e,n)):void a(c,e.parentNode,0)}function p(n,e,t){if(!(n instanceof Object))return e.nodeValue=k(n)?"":n,e}function v(n,e,t,a){var r=void 0;if(n&&c(r=a.$r||a,n))return n.$r=r,e}function h(e,t,a,r){this._boundActions=new n,this._parentInst=a,this.actions=r,this.props=t,this.render=e,this.bindSend=this.bindSend.bind(this),this.state=r.onInit(this),this.$n=C(this._instance=e(this))}function b(n,e,t,a){return new h(n,e,t,a)}function m(n,e){var t=n(e);return C(t),t}function g(n,e,t,a){var r=(e?b:m)(n,t||w,a,e);return r}function D(n,e,t,a){var r=e?a.updateProps(t):A(a,n(t));return r}function C(n){var e=n.$s.c(n);return n.$n=e,e.xvdom=n,e}function y(n){var e=n.$s,t=e.r.pop(n.key);return t?(e.u(n,t),t):(C(n),n)}function O(n,e,t){return t instanceof Array?(u(e,t,0),n?e:e.appendChild(I(""))):e.appendChild(t instanceof Object?C(t):I(k(t)?"":t))}function N(n,e,t,a){return(e instanceof Object?e instanceof Array?f(t,a,n,e):v(t,a,n,e):p(t,a,n))||s(n,t,a)}function A(n,e){return c(n,e)?n:(E(n.$n,(e=y(e)).$n),x(n),e)}function $(n){var e=this.tabs,t=this.selected,a=this.hrefPrefix,r=e[n],c=r.href,o=r.title;return{$s:J,a:"Tabs-tab u-cursor-pointer l-padding-h4 l-padding-b2 "+(t===n?"is-selected":""),c:""+a+(c||n),d:o||n,key:n}}function P(){if(firebase.auth().currentUser)return on.unsetCurrent(),firebase.auth().signOut();var n=new firebase.auth.GoogleAuthProvider;n.addScope("https://www.googleapis.com/auth/plus.login"),firebase.auth().signInWithPopup(n).catch((function(n){return console.error(n)}))}var k=function(n){return null==n||n===!0||n===!1},w={},S={push:function(){},pop:function(){}};n.prototype=Object.create(null),e.prototype.push=function(n){var e=n.key,t=this.map;n.$x=t[e],t[e]=n},e.prototype.pop=function(n){var e=this.map[n];if(e)return this.map[n]=e.$x,e};var x=function(n){n.$s.r.push(n)},I=function(n){return document.createTextNode(n)},E=function(n,e){var t=n.parentNode;t&&t.replaceChild(e,n)};h.prototype.updateProps=function(n){var e=this.props;return this.props=n,this.actions.onProps?this.send("onProps",e):this.rerender(),this},h.prototype.bindSend=function(n){return this._boundActions[n]||(this._boundActions[n]=this.send.bind(this,n))},h.prototype.send=function(n,e){var t=void 0,a=this.actions[n];a&&(t=a(this,e))!=this.state&&(this.state=t,this.rerender())},h.prototype.rerender=function(){var n=A(this._instance,this.render(this));this._instance=n,n.$n.xvdom=this._parentInst};var L=function(n){return y(n).$n},T=function(n,e){return A(n.xvdom,e).$n},j=function(n){t(n.xvdom,n.parentNode)},z={createComponent:g,createDynamic:O,el:function(n){return document.createElement(n)},render:L,rerender:T,unmount:j,updateComponent:D,updateDynamic:N,Pool:e,DEADPOOL:S},R=z.el,M={c:function(n){var e=R("i");return n.b=e,e.className=n.a,e.onClickArg=n.c,e.onClickFn=n.d,e.onclick=n.e,e},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.className=t,e.a=t),t=n.c,t!==e.c&&(e.b.onClickArg=t,e.c=t),t=n.d,t!==e.d&&(e.b.onClickFn=t,e.d=t),t=n.e,t!==e.e&&(e.b.onclick=t,e.e=t)},r:z.DEADPOOL},Y=function(n){var e=n.currentTarget;e.onClickFn(e.onClickArg)},q=function(n){var e=n.className,t=n.name,a=n.onClick,r=n.onClickArg,c=n.size,o=void 0===c?"med":c;return{$s:M,a:"Icon Icon--"+o+" octicon octicon-"+t+" "+e+" t-center",c:r,d:a,e:a&&Y}},_=z.createDynamic,F=z.el,U=z.updateDynamic,G={c:function(n){var e=F("div");return e.className="Tabs layout horizontal end center-justified c-white l-height10 t-font-size-14 t-uppercase t-normal",n.b=_(!0,e,n.a),e},u:function(n,e){n.a!==e.a&&(e.b=U(!0,e.a,e.a=n.a,e.b))},r:z.DEADPOOL},J={c:function(n){var e=F("a");return n.b=e,e.className=n.a,null!=n.c&&(e.href=n.c),n.e=_(!0,e,n.d),e},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.className=t,e.a=t),t=n.c,t!==e.c&&(e.b.href!==t&&(e.b.href=t),e.c=t),n.d!==e.d&&(e.e=U(!0,e.d,e.d=n.d,e.e))},r:z.DEADPOOL},B=function(n){return{$s:G,a:Object.keys(n.tabs).map($,n)}},H="ticker:storage",V=void 0;try{V=JSON.parse(localStorage.getItem(H))}catch(n){}V||localStorage.setItem(H,JSON.stringify(V=[]));var K=function(){var n=V.pop();n&&(localStorage.removeItem(n),Q(n,!1))},W=function(n,e){for(var t=V.length;t--;)try{return void localStorage.setItem(n,e)}catch(n){K()}},Q=function(n,e){var t=V.indexOf(n);t>=0&&V.splice(t,1),e&&V.unshift(n),W(H,JSON.stringify(V))},X=function(n){Q(n,!0)},Z={getItem:function(n){var e=localStorage.getItem(n);return e&&X(n),e},setItem:function(n,e){return W(n,e),X(n),e},getItemObj:function(n){var e=this.getItem(n),t=e&&JSON.parse(e);return t},setItemObj:function(n,e){return this.setItem(n,JSON.stringify(e)),e}},nn=(function(){function n(n){this.value=n}function e(e){function t(n,e){return new Promise(function(t,r){var i={key:n,arg:e,resolve:t,reject:r,next:null};o?o=o.next=i:(c=o=i,a(n,e))})}function a(t,c){try{var o=e[t](c),i=o.value;i instanceof n?Promise.resolve(i.value).then((function(n){a("next",n)}),(function(n){a("throw",n)})):r(o.done?"return":"normal",o.value)}catch(n){r("throw",n)}}function r(n,e){switch(n){case"return":c.resolve({value:e,done:!0});break;case"throw":c.reject(e);break;default:c.resolve({value:e,done:!1})}c=c.next,c?a(c.key,c.arg):o=null}var c,o;this._invoke=t,"function"!=typeof e.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(n){return this._invoke("next",n)},e.prototype.throw=function(n){return this._invoke("throw",n)},e.prototype.return=function(n){return this._invoke("return",n)},{wrap:function(n){return function(){return new e(n.apply(this,arguments))}},await:function(e){return new n(e)}}}(),Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a])}return n}),en=(function(){function n(n,e){var t=[],a=!0,r=!1,c=void 0;try{for(var o,i=n[Symbol.iterator]();!(a=(o=i.next()).done)&&(t.push(o.value),!e||t.length!==e);a=!0);}catch(n){r=!0,c=n}finally{try{!a&&i.return&&i.return()}finally{if(r)throw c}}return t}return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return n(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),tn=function(n){if(Array.isArray(n)){for(var e=0,t=Array(n.length);e<n.length;e++)t[e]=n[e];return t}return Array.from(n)},an="rc:lastLoggedInUserId",rn=function(n){return firebase.database().ref("users/"+n)},cn=function(n){return Z.setItemObj("rc:"+n.id,n)},on={current:function(){var n=Z.getItem(an);if(n)return this.localGet(n)},getCurrentId:function(){return Z.getItem(an)},setCurrent:function(n){return Z.setItem(an,n)},unsetCurrent:function(){var n=this.current();n&&(Z.setItemObj("rc:"+n.id,""),Z.setItem(an,""))},localGet:function(n){return Z.getItemObj("rc:"+n)},save:function(n){return new Promise(function(e,t){rn(n.id).set(n,(function(a){return a?t(a):void e(cn(nn({},n)))}))})},get:function(n){return new Promise(function(e,t){rn(n).once("value",(function(n){var a=n.val();return a?void e(cn(a)):t("Couldn't find User")}))})}},un=function(n,e,t){var a=function(t){var a=t.props,r=t.bindSend,c="function"==typeof n?n(a):n;return c[e](a).then(r("onLoadModel")),null};return t.state={onInit:a,onProps:function(n){return a(n),n.state},onLoadModel:function(n,e){return e},refresh:function(n){return a(n),n.state}},t},sn=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return firebase.database().ref("users/"+on.getCurrentId()+"/schools/"+n)},dn={query:function(){var n=on.getCurrentId();return n?new Promise(function(n,e){sn().once("value",(function(t){var a=t.val();return a?void n(a):e("Couldn't find schools for user "+id)}))}):void console.log("No user!")},create:function(n){var e=sn().push();e.set({name:n})},updateName:function(n,e){sn(n).update({name:e})},update:function(n,e){return sn(n).update(e)},get:function(n){var e=n.id;return new Promise(function(n,t){sn(e).once("value",(function(a){var r=a.val();return r?void n(r):t("Couldn't find schools for user "+e)}))})}},ln=z.createComponent,fn=z.createDynamic,pn=z.el,vn=z.updateComponent,hn=z.updateDynamic,bn={c:function(n){var e,t,a,r=pn("div");return n.b=r,r.className=n.a,e=pn("div"),n.d=e,e.className=n.c,t=pn("div"),t.className="layout horizontal center-center l-height14",n.f=fn(!1,t,n.e),a=pn("div"),a.className="l-padding-r0 t-truncate t-font-size-20 flex",n.h=a,a.textContent=n.g,t.appendChild(a),a=(n.j=ln(q,q.state,{className:"t-bold c-white l-padding-h4",onClick:n.i,size:"small"},n)).$n,t.appendChild(a),n.l=fn(!1,t,n.k),e.appendChild(t),n.n=fn(!1,e,n.m),r.appendChild(e),r},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.className=t,e.a=t),t=n.c,t!==e.c&&(e.d.className=t,e.c=t),n.e!==e.e&&(e.f=hn(!1,e.e,e.e=n.e,e.f)),t=n.g,t!==e.g&&(e.h.textContent=t,e.g=t),n.i!==e.i&&(e.j=vn(q,q.state,{className:"t-bold c-white l-padding-h4",onClick:e.i=n.i,size:"small"},e.j)),n.k!==e.k&&(e.l=hn(!1,e.k,e.k=n.k,e.l)),n.m!==e.m&&(e.n=hn(!1,e.m,e.m=n.m,e.n))},r:z.DEADPOOL},mn=function(){},gn=function(n){var e=n.props,t=e.title,a=e.secondary,r=e.left,c=e.right,o=n.state.scrollClass;return{$s:bn,a:"AppToolbar "+(a?"AppToolbar--withSecondary":""),c:"AppToolbar-bar fixed fixed--top c-white bg-purple "+o,e:r,g:t,i:mn,k:c,m:a}},Dn=function(n){var e=document.body?document.body.scrollTop:0,t=e>56&&e-n>0;return{scrollTop:e,scrollClass:t?" is-scrolling-down":""}};gn.state={onInit:function(n){var e=n.bindSend;return requestAnimationFrame((function(){return document.body.onscroll=e("onScroll")})),Dn(0)},onScroll:function(n){var e=n.state.scrollTop;return Dn(e)}};var Cn=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return firebase.database().ref("users/"+on.getCurrentId()+"/schools/"+n+"/students")},yn={query:function(n){var e=n.id,t=on.getCurrentId();return t?new Promise(function(n){Cn(e).once("value",(function(e){n(e.val()||[])}))}):(console.log("No user!"),Promise.resolve([]))},update:function(n,e){return Cn(n).set(e)}},On=z.createComponent,Nn=z.createDynamic,An=z.el,$n=z.updateComponent,Pn=z.updateDynamic,kn={c:function(n){var e,t,a=An("div");return e=An("div"),e.className="Card",t=An("div"),t.className="Card-title",n.b=Nn(!1,t,n.a),n.d=Nn(!1,t,n.c),e.appendChild(t),a.appendChild(e),a},u:function(n,e){n.a!==e.a&&(e.b=Pn(!1,e.a,e.a=n.a,e.b)),n.c!==e.c&&(e.d=Pn(!1,e.c,e.c=n.c,e.d))},r:z.DEADPOOL},wn={c:function(){var n=An("h1");return n.className="c-gray-dark t-center",n.appendChild(document.createTextNode("No students")),n},u:function(){},r:z.DEADPOOL},Sn={c:function(n){var e,t=An("div");return t.className="List-item layout horizontal",e=An("span"),e.className="flex",n.b=Nn(!0,e,n.a),t.appendChild(e),e=An("a"),n.d=e,e.onclick=n.c,e.appendChild(document.createTextNode("remove")),t.appendChild(e),t},u:function(n,e){var t;n.a!==e.a&&(e.b=Pn(!0,e.a,e.a=n.a,e.b)),t=n.c,t!==e.c&&(e.d.onclick=t,e.c=t)},r:z.DEADPOOL},xn={c:function(n){var e=(n.d=On(En,En.state,{id:n.a,students:n.b,onAdd:n.c},n)).$n;return e},u:function(n,e){n.b===e.b&&n.a===e.a&&n.c===e.c||(e.d=$n(En,En.state,{id:e.a=n.a,students:e.b=n.b,onAdd:e.c=n.c},e.d))},r:z.DEADPOOL},In={c:function(n){var e,t=An("div");return t.className="layout horizontal",e=An("input"),e.className="SchoolPage-input flex",n.b=e,e.oninput=n.a,null!=n.c&&(e.value=n.c),e.placeholder="Student's Name",t.appendChild(e),e=An("a"),n.e=e,e.hidden=n.d,e.className="self-center l-margin-l2",e.onclick=n.f,e.appendChild(document.createTextNode("Add")),t.appendChild(e),t},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.oninput=t,e.a=t),t=n.c,t!==e.c&&(e.b.value!==t&&(e.b.value=t),e.c=t),t=n.d,t!==e.d&&(e.e.hidden=t,e.d=t),t=n.f,t!==e.f&&(e.e.onclick=t,e.f=t)},r:z.DEADPOOL},En=function(n){var e=n.state,t=n.bindSend;return{$s:In,a:t("updateName"),c:e,d:!e,f:t("addStudent")}};En.state={onInit:function(){return""},onProps:function(){return""},updateName:function(n,e){return e.target.value},addStudent:function(n,e){var t=n.props,a=t.id,r=t.students,c=t.onAdd,o=n.state;return o&&r.indexOf(o)===-1&&yn.update(a,r.concat(o)).then(c),""}};var Ln=un(yn,"query",(function(n){var e=n.props.id,t=n.state,a=n.bindSend;return{$s:kn,a:t&&{$s:xn,a:e,b:t,c:a("refresh")},c:t&&t.length?t.map((function(n,r){return{$s:Sn,a:n,c:function(){yn.update(e,t.filter((function(e){return e!==n}))).then(a("refresh"))},key:n}})):[{$s:wn,key:"EMPTY"}]}})),Tn=10,jn=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return firebase.database().ref("users/"+on.getCurrentId()+"/schools/"+n+"/seating")},zn=function(n){for(var e=n.slice(),t=[];e.length>0;)t.push(e.splice(0,Tn));return t},Rn={query:function(n){var e=n.id,t=on.getCurrentId();return t?new Promise(function(n){jn(e).once("value",(function(t){var a=t.val();a?n(t.val()):yn.query({id:e}).then((function(t){if(t&&t.length){var a=zn(t);Rn.update(e,a),n(a)}else n([])}))}))}):(console.log("No user!"),Promise.resolve([]))},update:function(n,e){return jn(n).set(e)}},Mn=z.createComponent,Yn=z.createDynamic,qn=z.el,_n=z.updateComponent,Fn=z.updateDynamic,Un={c:function(n){var e,t,a=qn("div");return a.className="l-padding-t4",n.b=Yn(!1,a,n.a),e=qn("div"),e.className="layout horizontal l-padding-t2",e.style.cssText="padding-left: 22px",t=qn("a"),t.className="SeatingTab-addRow",n.d=t,t.onclick=n.c,t.appendChild(document.createTextNode("Add row")),e.appendChild(t),a.appendChild(e),a},u:function(n,e){var t;n.a!==e.a&&(e.b=Fn(!1,e.a,e.a=n.a,e.b)),t=n.c,t!==e.c&&(e.d.onclick=t,e.c=t)},r:z.DEADPOOL},Gn={c:function(n){var e=(n.g=Mn(Xn,Xn.state,{id:n.a,row:n.b,rowNum:n.c,onAssign:n.d,onAdd:n.e,onRemove:n.f},n)).$n;return e},u:function(n,e){n.e===e.e&&n.d===e.d&&n.c===e.c&&n.b===e.b&&n.a===e.a&&n.f===e.f||(e.g=_n(Xn,Xn.state,{id:e.a=n.a,row:e.b=n.b,rowNum:e.c=n.c,onAssign:e.d=n.d,onAdd:e.e=n.e,onRemove:e.f=n.f},e.g))},r:z.DEADPOOL},Jn={c:function(n){var e,t,a,r=qn("div");return n.b=Yn(!1,r,n.a),e=qn("div"),e.className="SeatingRow layout horizontal",t=qn("div"),t.className="SeatingRow-controls layout vertical around-justified",a=qn("a"),a.className="SeatingRow-controls-control",n.d=a,a.onclick=n.c,a.appendChild(document.createTextNode("+")),t.appendChild(a),a=qn("a"),a.className="SeatingRow-controls-control",n.f=a,a.onclick=n.e,a.appendChild(document.createTextNode("-")),t.appendChild(a),e.appendChild(t),n.h=Yn(!1,e,n.g),r.appendChild(e),r},u:function(n,e){var t;n.a!==e.a&&(e.b=Fn(!1,e.a,e.a=n.a,e.b)),t=n.c,t!==e.c&&(e.d.onclick=t,e.c=t),t=n.e,t!==e.e&&(e.f.onclick=t,e.e=t),n.g!==e.g&&(e.h=Fn(!1,e.g,e.g=n.g,e.h))},r:z.DEADPOOL},Bn={c:function(n){var e=qn("a");return n.b=e,e.className=n.a,e.onclick=n.c,e.seatindex=n.d,n.f=Yn(!0,e,n.e),e},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.className=t,e.a=t),t=n.c,t!==e.c&&(e.b.onclick=t,e.c=t),t=n.d,t!==e.d&&(e.b.seatindex=t,e.d=t),n.e!==e.e&&(e.f=Fn(!0,e.e,e.e=n.e,e.f))},r:z.DEADPOOL},Hn={c:function(n){var e=(n.e=Mn(Qn,Qn.state,{id:n.a,onAssign:n.b,onClose:n.c,seatIndex:n.d},n)).$n;return e},u:function(n,e){n.c===e.c&&n.b===e.b&&n.a===e.a&&n.d===e.d||(e.e=_n(Qn,Qn.state,{id:e.a=n.a,onAssign:e.b=n.b,onClose:e.c=n.c,seatIndex:e.d=n.d},e.e))},r:z.DEADPOOL},Vn={c:function(n){var e,t=qn("div");return t.className="AssignSeat",e=qn("div"),e.className="AssignSeat-backdrop",n.b=e,e.onclick=n.a,t.appendChild(e),n.d=Yn(!1,t,n.c),t},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.onclick=t,e.a=t),n.c!==e.c&&(e.d=Fn(!1,e.c,e.c=n.c,e.d))},r:z.DEADPOOL},Kn={c:function(n){var e,t=qn("div");return t.className="AssignSeat-card Card",e=qn("a"),e.className="List-item c-gray-dark",n.b=e,e.onclick=n.a,e.appendChild(document.createTextNode("EMPTY")),t.appendChild(e),n.d=Yn(!1,t,n.c),t},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.onclick=t,e.a=t),n.c!==e.c&&(e.d=Fn(!1,e.c,e.c=n.c,e.d))},r:z.DEADPOOL},Wn={c:function(n){var e=qn("a");return e.className="List-item",n.b=e,e.onclick=n.a,n.d=Yn(!0,e,n.c),e},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.onclick=t,e.a=t),n.c!==e.c&&(e.d=Fn(!0,e.c,e.c=n.c,e.d))},r:z.DEADPOOL},Qn=un(yn,"query",(function(n){var e=n.props,t=e.seatIndex,a=e.onAssign,r=e.onClose,c=n.state;return{$s:Vn,a:r,c:c&&{$s:Kn,a:function(){a({seatIndex:t,student:"EMPTY"})},c:c.sort().map((function(n){return{$s:Wn,a:function(){a({seatIndex:t,student:n})},c:n,key:n}}))}}})),Xn=function(n){var e=n.props,t=e.id,a=e.row,r=e.onAdd,c=e.onRemove,o=e.onAssign,i=n.state.seatIndex,u=n.bindSend;return{$s:Jn,a:null!=i&&{$s:Hn,a:t,b:o,c:u("onClose"),d:i},c:r,e:c,g:a.map((function(n,e){return{$s:Bn,a:"SeatingRow-seat "+("EMPTY"===n?"SeatingRow-seat--empty":""),c:u("openAssignSeat"),d:e,e:n,key:e}}))}};Xn.state={onInit:function(){return{}},onProps:function(){return{}},onClose:function(){return{}},openAssignSeat:function(n,e){var t=n.state,a=e.currentTarget;return a&&null!=a.seatindex?{seatIndex:a.seatindex}:t}};var Zn=un(Rn,"query",(function(n){var e=n.props.id,t=n.state,a=n.bindSend;return{$s:Un,a:t?t.map((function(n,r){return{$s:Gn,a:e,b:n,c:r,d:function(c){var o=c.seatIndex,i=c.student;if("EMPTY"!==i){var u=t.find((function(n){return n.indexOf(i)!==-1})),s=u&&u.indexOf(i);if(u===r&&s===o)return;var d=n[o];u&&(u[s]=d)}n[o]=i,Rn.update(e,t).then(a("refresh"))},e:function(){t[r]=n.concat("EMPTY"),Rn.update(e,t).then(a("refresh"))},f:function(){var c=t[r]=n.slice(0,-1);0===c.length&&t.splice(r,1),Rn.update(e,t).then(a("refresh"))},key:n.join("--")}})):[],c:function(){t.push(["EMPTY"]),Rn.update(e,t).then(a("refresh"))}}})),ne=function(n){return""+(n<10?"0":"")+n},ee=function(n){return n.getFullYear()+"-"+ne(n.getMonth()+1)+"-"+ne(n.getDate())},te=function(n,e){return firebase.database().ref("users/"+on.getCurrentId()+"/schools/"+n+"/rollcall/"+ee(e))},ae={query:function(n){var e=n.id,t=n.date,a=on.getCurrentId();return a?new Promise(function(n){te(e,t).once("value",(function(e){n(e.val()||[])}))}):(console.log("No user!"),Promise.resolve([]))},update:function(n,e,t){return te(n,e).set(t)}},re=["Here","Absent","No Instrument"],ce=z.createComponent,oe=z.createDynamic,ie=z.el,ue=z.updateComponent,se=z.updateDynamic,de={c:function(n){var e,t,a,r=ie("div");return e=ie("div"),e.className="layout horizontal center-center l-padding-t4",t=ie("div"),t.className="Rollcall-date layout horizontal center-center",a=ie("a"),a.className="Rollcall-dateInc",n.b=a,a.onclick=n.a,a.appendChild(document.createTextNode("<")),t.appendChild(a),a=ie("div"),a.className="flex t-center",n.d=oe(!1,a,n.c),a.appendChild(document.createTextNode(" - ")),n.f=oe(!1,a,n.e),a.appendChild(document.createTextNode(" - ")),n.h=oe(!1,a,n.g),t.appendChild(a),a=ie("a"),a.className="Rollcall-dateInc",n.j=a,a.onclick=n.i,a.appendChild(document.createTextNode(">")),t.appendChild(a),e.appendChild(t),r.appendChild(e),e=(n.m=ce(Ne,Ne.state,{date:n.k,id:n.l},n)).$n,r.appendChild(e),r},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.onclick=t,e.a=t),n.c!==e.c&&(e.d=se(!1,e.c,e.c=n.c,e.d)),n.e!==e.e&&(e.f=se(!1,e.e,e.e=n.e,e.f)),n.g!==e.g&&(e.h=se(!1,e.g,e.g=n.g,e.h)),t=n.i,t!==e.i&&(e.j.onclick=t,e.i=t),n.k===e.k&&n.l===e.l||(e.m=ue(Ne,Ne.state,{date:e.k=n.k,id:e.l=n.l},e.m))},r:z.DEADPOOL},le={c:function(n){var e=ie("div");return n.b=oe(!0,e,n.a),e},u:function(n,e){n.a!==e.a&&(e.b=se(!0,e.a,e.a=n.a,e.b))},r:z.DEADPOOL},fe={c:function(n){var e=(n.d=ce(Oe,Oe.state,{id:n.a,onToggleStatus:n.b,rollcall:n.c},n)).$n;return e},u:function(n,e){n.b===e.b&&n.a===e.a&&n.c===e.c||(e.d=ue(Oe,Oe.state,{id:e.a=n.a,onToggleStatus:e.b=n.b,rollcall:e.c=n.c},e.d))},r:z.DEADPOOL},pe={c:function(n){var e=ie("div");return n.b=oe(!0,e,n.a),e},u:function(n,e){n.a!==e.a&&(e.b=se(!0,e.a,e.a=n.a,e.b))},r:z.DEADPOOL},ve={c:function(n){var e=(n.f=ce(ye,ye.state,{id:n.a,onToggleStatus:n.b,rollcall:n.c,row:n.d,rowNum:n.e},n)).$n;return e},u:function(n,e){n.d===e.d&&n.c===e.c&&n.b===e.b&&n.a===e.a&&n.e===e.e||(e.f=ue(ye,ye.state,{id:e.a=n.a,onToggleStatus:e.b=n.b,rollcall:e.c=n.c,row:e.d=n.d,rowNum:e.e=n.e},e.f))},r:z.DEADPOOL},he={c:function(n){var e,t=ie("div");return t.className="l-padding-l4",e=ie("div"),e.className="SeatingRow layout horizontal",n.b=oe(!0,e,n.a),t.appendChild(e),t},u:function(n,e){n.a!==e.a&&(e.b=se(!0,e.a,e.a=n.a,e.b))},r:z.DEADPOOL},be={c:function(n){var e,t=ie("a");return n.b=t,t.className=n.a,t.onclick=n.c,e=ie("div"),n.e=oe(!0,e,n.d),t.appendChild(e),e=ie("div"),e.className="flex layout vertical center-center",n.g=oe(!0,e,n.f),t.appendChild(e),t},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.className=t,e.a=t),t=n.c,t!==e.c&&(e.b.onclick=t,e.c=t),n.d!==e.d&&(e.e=se(!0,e.d,e.d=n.d,e.e)),n.f!==e.f&&(e.g=se(!0,e.f,e.f=n.f,e.g))},r:z.DEADPOOL},me="EMPTY",ge=function(n,e){return e.find((function(e){var t=en(e,1),a=t[0];return a===n}))},De=function(n,e){var t=ge(n,e);return t?t[1]:""},Ce=function(n,e){var t=De(n,e);return"Here"===t?"is-here":"Absent"===t?"is-absent":"No Instrument"===t?"is-no-instrument":""},ye=function(n){var e=n.row,t=n.rollcall,a=n.onToggleStatus;return{$s:he,a:e.map((function(n,e){return{$s:be,a:"\n            SeatingRow-seat layout vertical center-center\n            "+(n===me?"SeatingRow-seat--empty":"")+"\n            "+Ce(n,t)+"\n          ",c:n===me?null:function(){return a(n)},d:n===me?"":n,f:De(n,t),key:e}}))}},Oe=un(Rn,"query",(function(n){var e=n.props,t=e.id,a=e.rollcall,r=e.onToggleStatus,c=n.state;return{$s:pe,a:c?c.map((function(n,e){return{$s:ve,a:t,b:r,c:a,d:n,e:e,key:n.join("--")}})):[]}})),Ne=un(ae,"query",(function(n){var e=n.props.id,t=n.state,a=n.bindSend;return{$s:le,a:t&&{$s:fe,a:e,b:a("onToggleStatus"),c:t}}})),Ae=function(n){return re[(re.indexOf(n)+1)%re.length]};Ne.state.onToggleStatus=function(n,e){var t=n.props,a=t.id,r=t.date,c=n.state;if(e){var o=ge(e,c);return o?o[1]=Ae(o[1]):(o=[e,re[0]],c.push(o)),ae.update(a,r,c),[].concat(tn(c))}};var $e=function(n){var e=n.props.id,t=n.state,a=n.bindSend;return{$s:de,a:a("decDate"),c:t.getMonth()+1,e:t.getDate(),g:t.getFullYear(),i:a("incDate"),k:t,l:e}},Pe=function(){return new Date},ke=function(n,e){return new Date(n.getFullYear(),n.getMonth(),n.getDate()+e)};$e.state={onInit:Pe,onProps:Pe,decDate:function(n){var e=n.state;return ke(e,-1)},incDate:function(n){var e=n.state;return ke(e,1)}};var we=function(n){return""+(n<10?"0":"")+n},Se=function(n){return n.getFullYear()+"-"+we(n.getMonth()+1)+"-"+we(n.getDate())},xe=function(n){return firebase.database().ref("users/"+on.getCurrentId()+"/schools/"+n+"/rollcall/")},Ie=function(n){var e={};return Object.keys(n).forEach((function(t){var a=n[t];a.forEach((function(n){var t=en(n,2),a=t[0],r=t[1],c=e[a];c||(e[a]=c={});var o=c[r];c[r]=o?o+1:1}))})),Object.keys(e).sort().map((function(n){return[n,e[n]]}))},Ee={query:function(n){var e=n.id,t=n.startDate,a=n.endDate,r=on.getCurrentId();return r?new Promise(function(n){xe(e).startAt(null,Se(t)).endAt(null,Se(a)).once("value",(function(e){n(Ie(e.val()))}))}):(console.log("No user!"),Promise.resolve([]))}},Le=z.createComponent,Te=z.createDynamic,je=z.el,ze=z.updateComponent,Re=z.updateDynamic,Me={c:function(n){var e,t,a,r=je("div");return e=je("div"),e.className="Card",t=je("div"),t.className="Card-title layout horizontal center-center",a=(n.c=Le(Je,Je.state,{value:n.a,onChange:n.b},n)).$n,t.appendChild(a),a=je("div"),a.className="l-margin-h4",a.appendChild(document.createTextNode("to")),t.appendChild(a),a=(n.f=Le(Je,Je.state,{value:n.d,onChange:n.e},n)).$n,t.appendChild(a),e.appendChild(t),r.appendChild(e),e=(n.j=Le(Ve,Ve.state,{id:n.g,startDate:n.h,endDate:n.i},n)).$n,r.appendChild(e),r},u:function(n,e){n.a===e.a&&n.b===e.b||(e.c=ze(Je,Je.state,{value:e.a=n.a,onChange:e.b=n.b},e.c)),n.d===e.d&&n.e===e.e||(e.f=ze(Je,Je.state,{value:e.d=n.d,onChange:e.e=n.e},e.f)),n.h===e.h&&n.g===e.g&&n.i===e.i||(e.j=ze(Ve,Ve.state,{id:e.g=n.g,startDate:e.h=n.h,endDate:e.i=n.i},e.j))},r:z.DEADPOOL},Ye={c:function(n){var e,t,a,r=je("div");return r.className="Card",e=je("div"),e.className="Card-title",t=je("div"),t.className="List-item layout horizontal justified c-gray-dark",a=je("div"),a.className="flex",a.appendChild(document.createTextNode("Name")),t.appendChild(a),n.b=Te(!1,t,n.a),e.appendChild(t),n.d=Te(!1,e,n.c),r.appendChild(e),r},u:function(n,e){n.a!==e.a&&(e.b=Re(!1,e.a,e.a=n.a,e.b)),n.c!==e.c&&(e.d=Re(!1,e.c,e.c=n.c,e.d))},r:z.DEADPOOL},qe={c:function(n){var e,t=je("div");return t.className="List-item layout horizontal justified",e=je("div"),e.className="flex",n.b=Te(!0,e,n.a),t.appendChild(e),n.d=Te(!1,t,n.c),t},u:function(n,e){n.a!==e.a&&(e.b=Re(!0,e.a,e.a=n.a,e.b)),n.c!==e.c&&(e.d=Re(!1,e.c,e.c=n.c,e.d))},r:z.DEADPOOL},_e={c:function(n){var e=je("div");return e.className="flex t-center",n.b=Te(!0,e,n.a),e},u:function(n,e){n.a!==e.a&&(e.b=Re(!0,e.a,e.a=n.a,e.b))},r:z.DEADPOOL},Fe={c:function(n){var e=je("div");return e.className="flex t-center",n.b=Te(!0,e,n.a),e},u:function(n,e){n.a!==e.a&&(e.b=Re(!0,e.a,e.a=n.a,e.b))},r:z.DEADPOOL},Ue={c:function(n){var e=je("input");return e.className="SchoolPage-input t-center",n.b=e,e.oninput=n.a,null!=n.c&&(e.value=n.c),e},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.oninput=t,e.a=t),t=n.c,t!==e.c&&(e.b.value!==t&&(e.b.value=t),e.c=t)},r:z.DEADPOOL},Ge=/(\d\d?)-(\d\d?)-(\d\d\d\d)/,Je=function(n){var e=n.state,t=n.bindSend;return{$s:Ue,a:t("onInput"),c:e}},Be=function(n){return Ge.test(n)},He=function(n){var e=n.props.value;return e};Je.state={onInit:He,onProps:He,onInput:function(n,e){var t=n.props,a=(t.id,t.onChange),r=n.state,c=e.target.value;return r!==c&&Be(c)&&setTimeout((function(){a(c)}),0),c}};var Ve=un(Ee,"query",(function(n){var e=n.props,t=(e.startDate,e.endDate,n.state);return{$s:Ye,a:re.map((function(n){return{$s:Fe,a:n,key:n}})),c:t?t.map((function(n){var e=en(n,2),t=e[0],a=e[1];return{$s:qe,a:t,c:re.map((function(n){return{$s:_e,a:a[n]||0,key:n}})),key:t}})):[]}})),Ke=function(n){return n.getMonth()+1+"-"+n.getDate()+"-"+n.getFullYear()},We=function(n){var e=n.props.id,t=n.state,a=t.startDate,r=t.endDate,c=n.bindSend;return{$s:Me,a:Ke(a),b:c("onStartDateChange"),d:Ke(r),e:c("onEndDateChange"),g:e,h:a,i:r}},Qe=function(){var n=new Date;return{endDate:new Date(n.getFullYear(),n.getMonth(),n.getDate()),startDate:new Date(n.getFullYear(),n.getMonth()-3,n.getDate())}};We.state={onInit:Qe,onProps:Qe,onStartDateChange:function(n,e){var t=n.state,a=Ge.exec(e).slice(1),r=en(a,3),c=r[0],o=r[1],i=r[2],u=new Date(+i,+c-1,+o);return nn({},t,{startDate:u})},onEndDateChange:function(n,e){var t=n.state,a=Ge.exec(e).slice(1),r=en(a,3),c=r[0],o=r[1],i=r[2],u=new Date(+i,+c-1,+o);return nn({},t,{endDate:u})}};var Xe=z.createComponent,Ze=z.createDynamic,nt=z.el,et=z.updateComponent,tt=z.updateDynamic,at={c:function(n){var e=(n.e=Xe(Nt,Nt.state,{id:n.a,page:n.b,tab:n.c,user:n.d},n)).$n;return e},u:function(n,e){n.c===e.c&&n.b===e.b&&n.a===e.a&&n.d===e.d||(e.e=et(Nt,Nt.state,{id:e.a=n.a,page:e.b=n.b,tab:e.c=n.c,user:e.d=n.d},e.e))},r:z.DEADPOOL},rt={c:function(n){var e=Xe(gt,gt.state,null,n).$n;return e},u:function(){},r:z.DEADPOOL},ct={c:function(n){var e=(n.d=Xe(B,B.state,{hrefPrefix:n.a,selected:n.b,tabs:n.c},n)).$n;return e},u:function(n,e){n.b===e.b&&n.a===e.a&&n.c===e.c||(e.d=et(B,B.state,{hrefPrefix:e.a=n.a,selected:e.b=n.b,tabs:e.c=n.c},e.d))},r:z.DEADPOOL},ot={c:function(n){var e=Xe(q,q.state,{className:"c-white l-padding-h4",name:"three-bars",size:"small"},n).$n;return e},u:function(){},r:z.DEADPOOL},it={c:function(n){var e,t=nt("div");return e=(n.d=Xe(gn,gn.state,{left:n.a,secondary:n.b,title:n.c},n)).$n,t.appendChild(e),n.f=Ze(!1,t,n.e),t},u:function(n,e){n.b===e.b&&n.a===e.a&&n.c===e.c||(e.d=et(gn,gn.state,{left:e.a=n.a,secondary:e.b=n.b,title:e.c=n.c},e.d)),n.e!==e.e&&(e.f=tt(!1,e.e,e.e=n.e,e.f))},r:z.DEADPOOL},ut={c:function(n){var e=(n.b=Xe(We,We.state,{id:n.a},n)).$n;return e},u:function(n,e){n.a!==e.a&&(e.b=et(We,We.state,{id:e.a=n.a},e.b))},r:z.DEADPOOL},st={c:function(n){var e=(n.b=Xe($e,$e.state,{id:n.a},n)).$n;return e},u:function(n,e){n.a!==e.a&&(e.b=et($e,$e.state,{id:e.a=n.a},e.b))},r:z.DEADPOOL},dt={c:function(n){var e=(n.b=Xe(Zn,Zn.state,{id:n.a},n)).$n;return e},u:function(n,e){n.a!==e.a&&(e.b=et(Zn,Zn.state,{id:e.a=n.a},e.b))},r:z.DEADPOOL},lt={c:function(n){var e=(n.b=Xe(Ln,Ln.state,{id:n.a},n)).$n;return e},u:function(n,e){n.a!==e.a&&(e.b=et(Ln,Ln.state,{id:e.a=n.a},e.b))},r:z.DEADPOOL},ft={c:function(n){var e=(n.b=Xe(yt,yt.state,{id:n.a},n)).$n;return e},u:function(n,e){n.a!==e.a&&(e.b=et(yt,yt.state,{id:e.a=n.a},e.b))},r:z.DEADPOOL},pt={c:function(n){var e,t,a=nt("div");return a.className="Card",e=nt("div"),e.className="Card-title",t=(n.c=Xe(Dt,Dt.state,{id:n.a,school:n.b},n)).$n,e.appendChild(t),a.appendChild(e),a},u:function(n,e){n.a===e.a&&n.b===e.b||(e.c=et(Dt,Dt.state,{id:e.a=n.a,school:e.b=n.b},e.c))},r:z.DEADPOOL},vt={c:function(n){var e=nt("input");return e.className="SchoolPage-input",n.b=e,e.oninput=n.a,null!=n.c&&(e.value=n.c),e},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.oninput=t,e.a=t),t=n.c,t!==e.c&&(e.b.value!==t&&(e.b.value=t),e.c=t)},r:z.DEADPOOL},ht={c:function(n){var e=Xe(q,q.state,{className:"c-white l-padding-h4",name:"three-bars",size:"small"},n).$n;return e},u:function(){},r:z.DEADPOOL},bt={c:function(n){var e,t=nt("div");return e=(n.b=Xe(gn,gn.state,{left:n.a},n)).$n,t.appendChild(e),t},u:function(n,e){n.a!==e.a&&(e.b=et(gn,gn.state,{left:e.a=n.a},e.b))},r:z.DEADPOOL},mt={school:{title:"School"},students:{title:"Students"},seating:{title:"Seating"},rollcall:{title:"Attendance"},reports:{title:"Reports"}},gt=function(){return{$s:bt,a:{$s:ht}}},Dt=function(n){var e=(n.props.id,n.state),t=n.bindSend;return{$s:vt,a:t("updateName"),c:e}},Ct=function(n){var e=n.props;return e.school&&e.school.name};Dt.state={onInit:Ct,onProps:Ct,updateName:function(n,e){var t=n.props.id,a=(n.state,e.target.value);return dn.updateName(t,a),a}};var yt=un(dn,"get",(function(n){var e=n.props.id,t=n.state;return{$s:pt,a:e,b:t}})),Ot=function(n,e){switch(e){case"school":return{$s:ft,a:n};case"students":return{$s:lt,a:n};case"seating":return{$s:dt,a:n};case"rollcall":return{$s:st,a:n};case"reports":return{$s:ut,a:n}}},Nt=un(dn,"get",(function(n){var e=n.props,t=e.id,a=e.tab,r=n.state;return{$s:it,a:{$s:ot},b:{$s:ct,a:"#schools/"+t+"/",b:a,c:mt},c:r?r.name:"",e:Ot(t,a)}})),At=function(n){var e=n.user,t=n.page,a=n.id,r=n.tab;return"new"===a?{$s:rt}:{$s:at,a:a,b:t,c:r,d:e}},$t=z.createComponent,Pt=z.createDynamic,kt=z.el,wt=z.updateComponent,St=z.updateDynamic,xt={c:function(n){var e=$t(Tt,Tt.state,null,n).$n;return e},u:function(){},r:z.DEADPOOL},It={c:function(n){var e=kt("body");return e.className="App",n.b=Pt(!1,e,n.a),n.d=Pt(!1,e,n.c),e},u:function(n,e){n.a!==e.a&&(e.b=St(!1,e.a,e.a=n.a,e.b)),n.c!==e.c&&(e.d=St(!1,e.c,e.c=n.c,e.d))},r:z.DEADPOOL},Et={c:function(n){var e=(n.e=$t(At,At.state,{user:n.a,page:n.b,id:n.c,tab:n.d},n)).$n;return e},u:function(n,e){n.c===e.c&&n.b===e.b&&n.a===e.a&&n.d===e.d||(e.e=wt(At,At.state,{user:e.a=n.a,page:e.b=n.b,id:e.c=n.c,tab:e.d=n.d},e.e))},r:z.DEADPOOL},Lt={c:function(n){var e,t=kt("div");return t.style.cssText="position: absolute; top: 0px; bottom: 0px; left: 0px; right: 0px;",t.className="layout horizontal center-center",e=kt("a"),n.b=e,e.onclick=n.a,e.className="l-padding-4",e.style.cssText="background: #CCC; border-radius: 6px;",n.d=Pt(!0,e,n.c),t.appendChild(e),t},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.onclick=t,e.a=t),n.c!==e.c&&(e.d=St(!0,e.c,e.c=n.c,e.d))},r:z.DEADPOOL},Tt=function(n){var e=n.state,t=e.user,a=e.page,r=e.id,c=e.tab,o=e.checkedLogin;return{$s:It,a:!t&&o&&{$s:Lt,a:P,c:t?"Sign out":"Sign in"
},c:t&&a&&r&&{$s:Et,a:t,b:a,c:r,d:c}}},jt=function(n){var e=n.state,t=window.location.hash.slice(1),a=t.split("/"),r=en(a,3),c=r[0],o=r[1],i=r[2];return nn({},e,{page:c,id:o,tab:i})};firebase.initializeApp({apiKey:"AIzaSyByU0ftUO7ECBLGGCb4awfe-u0ITxt0NVw",authDomain:"roll-call-1440c.firebaseapp.com",databaseURL:"https://roll-call-1440c.firebaseio.com",storageBucket:"roll-call-1440c.appspot.com",messagingSenderId:"115688293946"}),Tt.state={onInit:function(n){var e=n.bindSend;return firebase.auth().onAuthStateChanged((function(n){return n?void on.get(n.uid).catch((function(){return on.save({id:n.uid,displayName:n.displayName,schools:{_init:{name:"School #1"}}})})).then((function(n){on.setCurrent(n.id);var t=Object.keys(n.schools)[0],a=window.location.hash;a&&"#"!==a||(window.location.hash="#schools/"+t+"/school"),e("onUser")(n)})):e("onUser")(n)})),window.onhashchange=e("handleHashChange"),jt({user:on.current()})},onUser:function(n,e){var t=n.state;return nn({},t,{user:e,checkedLogin:!0})},handleHashChange:jt},document.body=z.render({$s:xt})})();

