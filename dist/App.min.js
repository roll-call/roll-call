!(function(){"use strict";function n(){}function e(){this.map=new n}function t(n,e){x(n),e.removeChild(n.$n)}function a(n,e,a){for(;a<n.length;)t(n[a++],e)}function r(n,e){for(var t=0;t<n.length;)x(n[t++]);e.textContent=""}function o(n,e){return n.$s===e.$s&&(e.$s.u(e,n),!0)}function c(n,e,t,a){null===a?u(n,e,t):i(n,e,t,a)}function i(n,e,t,a){for(;t<e.length;)n.insertBefore((e[t]=O(e[t])).$n,a),++t}function u(n,e,t){for(;t<e.length;)n.appendChild((e[t]=O(e[t])).$n),++t}function s(n,e,t){var a=document.createDocumentFragment(),r=C(n,a,e);return E(t,a),r}function d(n,e,t,r){for(var o=0;o<e.length&&o<t.length;o++)e[o]=A(t[o],e[o]);o<e.length?c(n,e,o,r):a(t,n,o)}function l(n,e,t){t.length?e.length?d(n,e,t,null):r(t,n):u(n,e,0)}function f(n,e,t,o){return n instanceof Array?(t?l(e,n,o):d(e.parentNode,n,o,e),e):t?(r(o,e),C(!0,e,n)):void a(o,e.parentNode,0)}function p(n,e,t){if(!(n instanceof Object))return e.nodeValue=k(n)?"":n,e}function h(n,e,t,a){var r=void 0;if(n&&o(r=a.$r||a,n))return n.$r=r,e}function v(e,t,a,r){this._boundActions=new n,this._parentInst=a,this.actions=r,this.props=t,this.render=e,this.bindSend=this.bindSend.bind(this),this.state=r.onInit(this),this.$n=D(this._instance=e(this))}function b(n,e,t,a){return new v(n,e,t,a)}function m(n,e){var t=n(e);return D(t),t}function g(n,e,t,a){var r=(e?b:m)(n,t||w,a,e);return r}function y(n,e,t,a){var r=e?a.updateProps(t):A(a,n(t));return r}function D(n){var e=n.$s.c(n);return n.$n=e,e.xvdom=n,e}function O(n){var e=n.$s,t=e.r.pop(n.key);return t?(e.u(n,t),t):(D(n),n)}function C(n,e,t){return t instanceof Array?(u(e,t,0),n?e:e.appendChild(I(""))):e.appendChild(t instanceof Object?D(t):I(k(t)?"":t))}function N(n,e,t,a){return(e instanceof Object?e instanceof Array?f(t,a,n,e):h(t,a,n,e):p(t,a,n))||s(n,t,a)}function A(n,e){return o(n,e)?n:(E(n.$n,(e=O(e)).$n),x(n),e)}function $(n){var e=this.tabs,t=this.selected,a=this.hrefPrefix,r=e[n],o=r.href,c=r.title;return{$s:J,a:"Tabs-tab u-cursor-pointer l-padding-h4 l-padding-b2 "+(t===n?"is-selected":""),c:""+a+(o||n),d:c||n,key:n}}function P(){if(firebase.auth().currentUser)return cn.unsetCurrent(),firebase.auth().signOut();var n=new firebase.auth.GoogleAuthProvider;n.addScope("https://www.googleapis.com/auth/plus.login"),firebase.auth().signInWithPopup(n).catch((function(n){return console.error(n)}))}var k=function(n){return null==n||n===!0||n===!1},w={},S={push:function(){},pop:function(){}};n.prototype=Object.create(null),e.prototype.push=function(n){var e=n.key,t=this.map;n.$x=t[e],t[e]=n},e.prototype.pop=function(n){var e=this.map[n];if(e)return this.map[n]=e.$x,e};var x=function(n){n.$s.r.push(n)},I=function(n){return document.createTextNode(n)},E=function(n,e){var t=n.parentNode;t&&t.replaceChild(e,n)};v.prototype.updateProps=function(n){var e=this.props;return this.props=n,this.actions.onProps?this.send("onProps",e):this.rerender(),this},v.prototype.bindSend=function(n){return this._boundActions[n]||(this._boundActions[n]=this.send.bind(this,n))},v.prototype.send=function(n,e){var t=void 0,a=this.actions[n];a&&(t=a(this,e))!=this.state&&(this.state=t,this.rerender())},v.prototype.rerender=function(){var n=A(this._instance,this.render(this));this._instance=n,n.$n.xvdom=this._parentInst};var L=function(n){return O(n).$n},T=function(n,e){return A(n.xvdom,e).$n},j=function(n){t(n.xvdom,n.parentNode)},z={createComponent:g,createDynamic:C,el:function(n){return document.createElement(n)},render:L,rerender:T,unmount:j,updateComponent:y,updateDynamic:N,Pool:e,DEADPOOL:S},R=z.el,_={c:function(n){var e=R("i");return n.b=e,e.className=n.a,e.onClickArg=n.c,e.onClickFn=n.d,e.onclick=n.e,e},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.className=t,e.a=t),t=n.c,t!==e.c&&(e.b.onClickArg=t,e.c=t),t=n.d,t!==e.d&&(e.b.onClickFn=t,e.d=t),t=n.e,t!==e.e&&(e.b.onclick=t,e.e=t)},r:z.DEADPOOL},M=function(n){var e=n.currentTarget;e.onClickFn(e.onClickArg)},q=function(n){var e=n.className,t=n.name,a=n.onClick,r=n.onClickArg,o=n.size,c=void 0===o?"med":o;return{$s:_,a:"Icon Icon--"+c+" octicon octicon-"+t+" "+e+" t-center",c:r,d:a,e:a&&M}},Y=z.createDynamic,U=z.el,F=z.updateDynamic,G={c:function(n){var e=U("div");return e.className="Tabs layout horizontal end center-justified c-white l-height10 t-font-size-14 t-uppercase t-normal",n.b=Y(!0,e,n.a),e},u:function(n,e){n.a!==e.a&&(e.b=F(!0,e.a,e.a=n.a,e.b))},r:z.DEADPOOL},J={c:function(n){var e=U("a");return n.b=e,e.className=n.a,null!=n.c&&(e.href=n.c),n.e=Y(!0,e,n.d),e},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.className=t,e.a=t),t=n.c,t!==e.c&&(e.b.href!==t&&(e.b.href=t),e.c=t),n.d!==e.d&&(e.e=F(!0,e.d,e.d=n.d,e.e))},r:z.DEADPOOL},B=function(n){return{$s:G,a:Object.keys(n.tabs).map($,n)}},H="ticker:storage",V=void 0;try{V=JSON.parse(localStorage.getItem(H))}catch(n){}V||localStorage.setItem(H,JSON.stringify(V=[]));var K=function(){var n=V.pop();n&&(localStorage.removeItem(n),Q(n,!1))},W=function(n,e){for(var t=V.length;t--;)try{return void localStorage.setItem(n,e)}catch(n){K()}},Q=function(n,e){var t=V.indexOf(n);t>=0&&V.splice(t,1),e&&V.unshift(n),W(H,JSON.stringify(V))},X=function(n){Q(n,!0)},Z={getItem:function(n){var e=localStorage.getItem(n);return e&&X(n),e},setItem:function(n,e){return W(n,e),X(n),e},getItemObj:function(n){var e=this.getItem(n),t=e&&JSON.parse(e);return t},setItemObj:function(n,e){return this.setItem(n,JSON.stringify(e)),e}},nn=(function(){function n(n){this.value=n}function e(e){function t(n,e){return new Promise(function(t,r){var i={key:n,arg:e,resolve:t,reject:r,next:null};c?c=c.next=i:(o=c=i,a(n,e))})}function a(t,o){try{var c=e[t](o),i=c.value;i instanceof n?Promise.resolve(i.value).then((function(n){a("next",n)}),(function(n){a("throw",n)})):r(c.done?"return":"normal",c.value)}catch(n){r("throw",n)}}function r(n,e){switch(n){case"return":o.resolve({value:e,done:!0});break;case"throw":o.reject(e);break;default:o.resolve({value:e,done:!1})}o=o.next,o?a(o.key,o.arg):c=null}var o,c;this._invoke=t,"function"!=typeof e.return&&(this.return=void 0)}return"function"==typeof Symbol&&Symbol.asyncIterator&&(e.prototype[Symbol.asyncIterator]=function(){return this}),e.prototype.next=function(n){return this._invoke("next",n)},e.prototype.throw=function(n){return this._invoke("throw",n)},e.prototype.return=function(n){return this._invoke("return",n)},{wrap:function(n){return function(){return new e(n.apply(this,arguments))}},await:function(e){return new n(e)}}}(),Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a])}return n}),en=(function(){function n(n,e){var t=[],a=!0,r=!1,o=void 0;try{for(var c,i=n[Symbol.iterator]();!(a=(c=i.next()).done)&&(t.push(c.value),!e||t.length!==e);a=!0);}catch(n){r=!0,o=n}finally{try{!a&&i.return&&i.return()}finally{if(r)throw o}}return t}return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return n(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}})(),tn=function(n){if(Array.isArray(n)){for(var e=0,t=Array(n.length);e<n.length;e++)t[e]=n[e];return t}return Array.from(n)},an="rc:lastLoggedInUserId",rn=function(n){return firebase.database().ref("users/"+n)},on=function(n){return Z.setItemObj("rc:"+n.id,n)},cn={current:function(){var n=Z.getItem(an);if(n)return this.localGet(n)},getCurrentId:function(){return Z.getItem(an)},setCurrent:function(n){return Z.setItem(an,n)},unsetCurrent:function(){var n=this.current();n&&(Z.setItemObj("rc:"+n.id,""),Z.setItem(an,""))},localGet:function(n){return Z.getItemObj("rc:"+n)},save:function(n){return new Promise(function(e,t){rn(n.id).set(n,(function(a){return a?t(a):void e(on(nn({},n)))}))})},get:function(n){return new Promise(function(e,t){rn(n).once("value",(function(n){var a=n.val();return a?void e(on(a)):t("Couldn't find User")}))})}},un=function(n,e,t){var a=function(t){var a=t.props,r=t.bindSend,o="function"==typeof n?n(a):n;return o[e](a).then(r("onLoadModel")),null};return t.state={onInit:a,onProps:function(n){return a(n),n.state},onLoadModel:function(n,e){return e},refresh:function(n){return a(n),n.state}},t},sn=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return firebase.database().ref("users/"+cn.getCurrentId()+"/schools/"+n)},dn={query:function(){var n=cn.getCurrentId;return n?new Promise(function(n,e){sn().once("value",(function(t){var a=t.val();return a?void n(a):e("Couldn't find schools for user "+id)}))}):void console.log("No user!")},create:function(n){var e=sn().push();e.set({name:n})},updateName:function(n,e){sn(n).update({name:e})},update:function(n,e){return sn(n).update(e)},get:function(n){var e=n.id;return new Promise(function(n,t){sn(e).once("value",(function(a){var r=a.val();return r?void n(r):t("Couldn't find schools for user "+e)}))})}},ln=z.createComponent,fn=z.createDynamic,pn=z.el,hn=z.updateComponent,vn=z.updateDynamic,bn={c:function(n){var e,t,a,r=pn("div");return n.b=r,r.className=n.a,e=pn("div"),n.d=e,e.className=n.c,t=pn("div"),t.className="layout horizontal center-center l-height14",n.f=fn(!1,t,n.e),a=pn("div"),a.className="l-padding-r0 t-truncate t-font-size-20 flex",n.h=a,a.textContent=n.g,t.appendChild(a),a=(n.j=ln(q,q.state,{className:"t-bold c-white l-padding-h4",onClick:n.i,size:"small"},n)).$n,t.appendChild(a),n.l=fn(!1,t,n.k),e.appendChild(t),n.n=fn(!1,e,n.m),r.appendChild(e),r},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.className=t,e.a=t),t=n.c,t!==e.c&&(e.d.className=t,e.c=t),n.e!==e.e&&(e.f=vn(!1,e.e,e.e=n.e,e.f)),t=n.g,t!==e.g&&(e.h.textContent=t,e.g=t),n.i!==e.i&&(e.j=hn(q,q.state,{className:"t-bold c-white l-padding-h4",onClick:e.i=n.i,size:"small"},e.j)),n.k!==e.k&&(e.l=vn(!1,e.k,e.k=n.k,e.l)),n.m!==e.m&&(e.n=vn(!1,e.m,e.m=n.m,e.n))},r:z.DEADPOOL},mn=function(){},gn=function(n){var e=n.props,t=e.title,a=e.secondary,r=e.left,o=e.right,c=n.state.scrollClass;return{$s:bn,a:"AppToolbar "+(a?"AppToolbar--withSecondary":""),c:"AppToolbar-bar fixed fixed--top c-white bg-purple "+c,e:r,g:t,i:mn,k:o,m:a}},yn=function(n){var e=document.body?document.body.scrollTop:0,t=e>56&&e-n>0;return{scrollTop:e,scrollClass:t?" is-scrolling-down":""}};gn.state={onInit:function(n){var e=n.bindSend;return requestAnimationFrame((function(){return document.body.onscroll=e("onScroll")})),yn(0)},onScroll:function(n){var e=n.state.scrollTop;return yn(e)}};var Dn=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return firebase.database().ref("users/"+cn.getCurrentId()+"/schools/"+n+"/students")},On={query:function(n){var e=n.id,t=cn.getCurrentId;return t?new Promise(function(n){Dn(e).once("value",(function(e){n(e.val()||[])}))}):(console.log("No user!"),Promise.resolve([]))},update:function(n,e){return Dn(n).set(e)}},Cn=z.createComponent,Nn=z.createDynamic,An=z.el,$n=z.updateComponent,Pn=z.updateDynamic,kn={c:function(n){var e,t,a=An("div");return e=An("div"),e.className="Card",t=An("div"),t.className="Card-title",n.b=Nn(!1,t,n.a),n.d=Nn(!1,t,n.c),e.appendChild(t),a.appendChild(e),a},u:function(n,e){n.a!==e.a&&(e.b=Pn(!1,e.a,e.a=n.a,e.b)),n.c!==e.c&&(e.d=Pn(!1,e.c,e.c=n.c,e.d))},r:z.DEADPOOL},wn={c:function(){var n=An("h1");return n.className="c-gray-dark t-center",n.appendChild(document.createTextNode("No students")),n},u:function(){},r:z.DEADPOOL},Sn={c:function(n){var e,t=An("div");return t.className="List-item layout horizontal",e=An("span"),e.className="flex",n.b=Nn(!0,e,n.a),t.appendChild(e),e=An("a"),n.d=e,e.onclick=n.c,e.appendChild(document.createTextNode("remove")),t.appendChild(e),t},u:function(n,e){var t;n.a!==e.a&&(e.b=Pn(!0,e.a,e.a=n.a,e.b)),t=n.c,t!==e.c&&(e.d.onclick=t,e.c=t)},r:z.DEADPOOL},xn={c:function(n){var e=(n.d=Cn(En,En.state,{id:n.a,students:n.b,onAdd:n.c},n)).$n;return e},u:function(n,e){n.b===e.b&&n.a===e.a&&n.c===e.c||(e.d=$n(En,En.state,{id:e.a=n.a,students:e.b=n.b,onAdd:e.c=n.c},e.d))},r:z.DEADPOOL},In={c:function(n){var e,t=An("div");return t.className="layout horizontal",e=An("input"),e.className="SchoolPage-input flex",n.b=e,e.oninput=n.a,null!=n.c&&(e.value=n.c),e.placeholder="Student's Name",t.appendChild(e),e=An("a"),n.e=e,e.hidden=n.d,e.className="self-center l-margin-l2",e.onclick=n.f,e.appendChild(document.createTextNode("Add")),t.appendChild(e),t},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.oninput=t,e.a=t),t=n.c,t!==e.c&&(e.b.value!==t&&(e.b.value=t),e.c=t),t=n.d,t!==e.d&&(e.e.hidden=t,e.d=t),t=n.f,t!==e.f&&(e.e.onclick=t,e.f=t)},r:z.DEADPOOL},En=function(n){var e=n.state,t=n.bindSend;return{$s:In,a:t("updateName"),c:e,d:!e,f:t("addStudent")}};En.state={onInit:function(){return""},onProps:function(){return""},updateName:function(n,e){return e.target.value},addStudent:function(n,e){var t=n.props,a=t.id,r=t.students,o=t.onAdd,c=n.state;return c&&r.indexOf(c)===-1&&On.update(a,r.concat(c)).then(o),""}};var Ln=un(On,"query",(function(n){var e=n.props.id,t=n.state,a=n.bindSend;return{$s:kn,a:t&&{$s:xn,a:e,b:t,c:a("refresh")},c:t&&t.length?t.map((function(n,r){return{$s:Sn,a:n,c:function(){On.update(e,t.filter((function(e){return e!==n}))).then(a("refresh"))},key:n}})):[{$s:wn,key:"EMPTY"}]}})),Tn=10,jn=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return firebase.database().ref("users/"+cn.getCurrentId()+"/schools/"+n+"/seating")},zn=function(n){for(var e=n.slice(),t=[];e.length>0;)t.push(e.splice(0,Tn));return t},Rn={query:function(n){var e=n.id,t=cn.getCurrentId;return t?new Promise(function(n){jn(e).once("value",(function(t){var a=t.val();a?n(t.val()):On.query({id:e}).then((function(t){if(t&&t.length){var a=zn(t);Rn.update(e,a),n(a)}else n([])}))}))}):(console.log("No user!"),Promise.resolve([]))},update:function(n,e){return jn(n).set(e)}},_n=z.createComponent,Mn=z.createDynamic,qn=z.el,Yn=z.updateComponent,Un=z.updateDynamic,Fn={c:function(n){var e,t,a=qn("div");return a.className="l-padding-t4",n.b=Mn(!1,a,n.a),e=qn("div"),e.className="layout horizontal l-padding-t2",e.style.cssText="padding-left: 22px",t=qn("a"),t.className="SeatingTab-addRow",n.d=t,t.onclick=n.c,t.appendChild(document.createTextNode("Add row")),e.appendChild(t),a.appendChild(e),a},u:function(n,e){var t;n.a!==e.a&&(e.b=Un(!1,e.a,e.a=n.a,e.b)),t=n.c,t!==e.c&&(e.d.onclick=t,e.c=t)},r:z.DEADPOOL},Gn={c:function(n){var e=(n.g=_n(Xn,Xn.state,{id:n.a,row:n.b,rowNum:n.c,onAssign:n.d,onAdd:n.e,onRemove:n.f},n)).$n;return e},u:function(n,e){n.e===e.e&&n.d===e.d&&n.c===e.c&&n.b===e.b&&n.a===e.a&&n.f===e.f||(e.g=Yn(Xn,Xn.state,{id:e.a=n.a,row:e.b=n.b,rowNum:e.c=n.c,onAssign:e.d=n.d,onAdd:e.e=n.e,onRemove:e.f=n.f},e.g))},r:z.DEADPOOL},Jn={c:function(n){var e,t,a,r=qn("div");return n.b=Mn(!1,r,n.a),e=qn("div"),e.className="SeatingRow layout horizontal",t=qn("div"),t.className="SeatingRow-controls layout vertical around-justified",a=qn("a"),a.className="SeatingRow-controls-control",n.d=a,a.onclick=n.c,a.appendChild(document.createTextNode("+")),t.appendChild(a),a=qn("a"),a.className="SeatingRow-controls-control",n.f=a,a.onclick=n.e,a.appendChild(document.createTextNode("-")),t.appendChild(a),e.appendChild(t),n.h=Mn(!1,e,n.g),r.appendChild(e),r},u:function(n,e){var t;n.a!==e.a&&(e.b=Un(!1,e.a,e.a=n.a,e.b)),t=n.c,t!==e.c&&(e.d.onclick=t,e.c=t),t=n.e,t!==e.e&&(e.f.onclick=t,e.e=t),n.g!==e.g&&(e.h=Un(!1,e.g,e.g=n.g,e.h))},r:z.DEADPOOL},Bn={c:function(n){var e=qn("a");return n.b=e,e.className=n.a,e.seatindex=n.c,e.onclick=n.d,n.f=Mn(!0,e,n.e),e},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.className=t,e.a=t),t=n.c,t!==e.c&&(e.b.seatindex=t,e.c=t),t=n.d,t!==e.d&&(e.b.onclick=t,e.d=t),n.e!==e.e&&(e.f=Un(!0,e.e,e.e=n.e,e.f))},r:z.DEADPOOL},Hn={c:function(n){var e=(n.e=_n(Qn,Qn.state,{id:n.a,seatIndex:n.b,onAssign:n.c,onClose:n.d},n)).$n;return e},u:function(n,e){n.c===e.c&&n.b===e.b&&n.a===e.a&&n.d===e.d||(e.e=Yn(Qn,Qn.state,{id:e.a=n.a,seatIndex:e.b=n.b,onAssign:e.c=n.c,onClose:e.d=n.d},e.e))},r:z.DEADPOOL},Vn={c:function(n){var e,t=qn("div");return t.className="AssignSeat",e=qn("div"),e.className="AssignSeat-backdrop",n.b=e,e.onclick=n.a,t.appendChild(e),n.d=Mn(!1,t,n.c),t},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.onclick=t,e.a=t),n.c!==e.c&&(e.d=Un(!1,e.c,e.c=n.c,e.d))},r:z.DEADPOOL},Kn={c:function(n){var e=qn("div");return e.className="AssignSeat-card Card",n.b=Mn(!0,e,n.a),e},u:function(n,e){n.a!==e.a&&(e.b=Un(!0,e.a,e.a=n.a,e.b))},r:z.DEADPOOL},Wn={c:function(n){var e=qn("a");return e.className="List-item",n.b=e,e.onclick=n.a,n.d=Mn(!0,e,n.c),e},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.onclick=t,e.a=t),n.c!==e.c&&(e.d=Un(!0,e.c,e.c=n.c,e.d))},r:z.DEADPOOL},Qn=un(On,"query",(function(n){var e=n.props,t=e.seatIndex,a=e.onAssign,r=e.onClose,o=n.state;return{$s:Vn,a:r,c:o&&{$s:Kn,a:o.sort().map((function(n){return{$s:Wn,a:function(){a({seatIndex:t,student:n})},c:n,key:n}}))}}})),Xn=function(n){var e=n.props,t=e.id,a=e.row,r=e.onAdd,o=e.onRemove,c=e.onAssign,i=n.state.seatIndex,u=n.bindSend;return{$s:Jn,a:null!=i&&{$s:Hn,a:t,b:i,c:c,d:u("onClose")},c:r,e:o,g:a.map((function(n,e){return{$s:Bn,a:"SeatingRow-seat "+("EMPTY"===n?"SeatingRow-seat--empty":""),c:e,d:u("openAssignSeat"),e:n,key:e}}))}};Xn.state={onInit:function(){return{}},onProps:function(){return{}},onClose:function(){return{}},openAssignSeat:function(n,e){var t=n.state,a=e.currentTarget;return a&&null!=a.seatindex?{seatIndex:a.seatindex}:t}};var Zn=un(Rn,"query",(function(n){var e=n.props.id,t=n.state,a=n.bindSend;return{$s:Fn,a:t?t.map((function(n,r){return{$s:Gn,a:e,b:n,c:r,d:function(o){var c=o.seatIndex,i=o.student,u=t.find((function(n){return n.indexOf(i)!==-1})),s=u&&u.indexOf(i);if(u!==r||s!==c){var d=n[c];u&&(u[s]=d),n[c]=i,Rn.update(e,t).then(a("refresh"))}},e:function(){t[r]=n.concat("EMPTY"),Rn.update(e,t).then(a("refresh"))},f:function(){var o=t[r]=n.slice(0,-1);0===o.length&&t.splice(r,1),Rn.update(e,t).then(a("refresh"))},key:n.join("--")}})):[],c:function(){t.push(["EMPTY"]),Rn.update(e,t).then(a("refresh"))}}})),ne=function(n){return""+(n<10?"0":"")+n},ee=function(n){return n.getFullYear()+"-"+ne(n.getMonth()+1)+"-"+ne(n.getDate()+1)},te=function(n,e){return firebase.database().ref("users/"+cn.getCurrentId()+"/schools/"+n+"/rollcall/"+ee(e))},ae={query:function(n){var e=n.id,t=n.date,a=cn.getCurrentId;return a?new Promise(function(n){te(e,t).once("value",(function(e){n(e.val()||[])}))}):(console.log("No user!"),Promise.resolve([]))},update:function(n,e,t){return te(n,e).set(t)}},re=z.createComponent,oe=z.createDynamic,ce=z.el,ie=z.updateComponent,ue=z.updateDynamic,se={c:function(n){var e,t,a,r=ce("div");return e=ce("div"),e.className="layout horizontal center-center l-padding-t4",t=ce("div"),t.className="Rollcall-date layout horizontal center-center",a=ce("a"),a.className="Rollcall-dateInc",n.b=a,a.onclick=n.a,a.appendChild(document.createTextNode("<")),t.appendChild(a),a=ce("div"),a.className="flex t-center",n.d=oe(!1,a,n.c),a.appendChild(document.createTextNode(" - ")),n.f=oe(!1,a,n.e),a.appendChild(document.createTextNode(" - ")),n.h=oe(!1,a,n.g),t.appendChild(a),a=ce("a"),a.className="Rollcall-dateInc",n.j=a,a.onclick=n.i,a.appendChild(document.createTextNode(">")),t.appendChild(a),e.appendChild(t),r.appendChild(e),e=(n.m=re(Ce,Ce.state,{id:n.k,date:n.l},n)).$n,r.appendChild(e),r},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.onclick=t,e.a=t),n.c!==e.c&&(e.d=ue(!1,e.c,e.c=n.c,e.d)),n.e!==e.e&&(e.f=ue(!1,e.e,e.e=n.e,e.f)),n.g!==e.g&&(e.h=ue(!1,e.g,e.g=n.g,e.h)),t=n.i,t!==e.i&&(e.j.onclick=t,e.i=t),n.k===e.k&&n.l===e.l||(e.m=ie(Ce,Ce.state,{id:e.k=n.k,date:e.l=n.l},e.m))},r:z.DEADPOOL},de={c:function(n){var e=ce("div");return n.b=oe(!0,e,n.a),e},u:function(n,e){n.a!==e.a&&(e.b=ue(!0,e.a,e.a=n.a,e.b))},r:z.DEADPOOL},le={c:function(n){var e=(n.d=re(Oe,Oe.state,{id:n.a,rollcall:n.b,onToggleStatus:n.c},n)).$n;return e},u:function(n,e){n.b===e.b&&n.a===e.a&&n.c===e.c||(e.d=ie(Oe,Oe.state,{id:e.a=n.a,rollcall:e.b=n.b,onToggleStatus:e.c=n.c},e.d))},r:z.DEADPOOL},fe={c:function(n){var e=ce("div");return n.b=oe(!0,e,n.a),e},u:function(n,e){n.a!==e.a&&(e.b=ue(!0,e.a,e.a=n.a,e.b))},r:z.DEADPOOL},pe={c:function(n){var e=(n.f=re(De,De.state,{id:n.a,row:n.b,rowNum:n.c,rollcall:n.d,onToggleStatus:n.e},n)).$n;return e},u:function(n,e){n.d===e.d&&n.c===e.c&&n.b===e.b&&n.a===e.a&&n.e===e.e||(e.f=ie(De,De.state,{id:e.a=n.a,row:e.b=n.b,rowNum:e.c=n.c,rollcall:e.d=n.d,onToggleStatus:e.e=n.e},e.f))},r:z.DEADPOOL},he={c:function(n){var e,t=ce("div");return t.className="l-padding-l4",e=ce("div"),e.className="SeatingRow layout horizontal",n.b=oe(!0,e,n.a),t.appendChild(e),t},u:function(n,e){n.a!==e.a&&(e.b=ue(!0,e.a,e.a=n.a,e.b))},r:z.DEADPOOL},ve={c:function(n){var e,t=ce("a");return n.b=t,t.className=n.a,t.onclick=n.c,e=ce("div"),n.e=oe(!0,e,n.d),t.appendChild(e),e=ce("div"),e.className="flex layout vertical center-center",n.g=oe(!0,e,n.f),t.appendChild(e),t},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.className=t,e.a=t),t=n.c,t!==e.c&&(e.b.onclick=t,e.c=t),n.d!==e.d&&(e.e=ue(!0,e.d,e.d=n.d,e.e)),n.f!==e.f&&(e.g=ue(!0,e.f,e.f=n.f,e.g))},r:z.DEADPOOL},be=["Here","Absent","No Instrument"],me=function(n,e){return e.find((function(e){var t=en(e,1),a=t[0];return a===n}))},ge=function(n,e){var t=me(n,e);return t?t[1]:""},ye=function(n,e){var t=ge(n,e);return"Here"===t?"is-here":"Absent"===t?"is-absent":"No Instrument"===t?"is-no-instrument":""},De=function(n){var e=n.row,t=n.rollcall,a=n.onToggleStatus;return{$s:he,a:e.map((function(n,e){return{$s:ve,a:"SeatingRow-seat layout vertical center-center "+("EMPTY"===n?"SeatingRow-seat--empty":"")+" "+ye(n,t),c:"EMPTY"===n?null:function(){return a(n)},d:"EMPTY"===n?"":n,f:ge(n,t),key:e}}))}},Oe=un(Rn,"query",(function(n){var e=n.props,t=e.id,a=e.rollcall,r=e.onToggleStatus,o=n.state;n.bindSend;return{$s:fe,a:o?o.map((function(n,e){return{$s:pe,a:t,b:n,c:e,d:a,e:r,key:n.join("--")}})):[]}})),Ce=un(ae,"query",(function(n){var e=n.props.id,t=n.state,a=n.bindSend;return{$s:de,a:t&&{$s:le,a:e,b:t,c:a("onToggleStatus")}}})),Ne=function(n){return be[(be.indexOf(n)+1)%be.length]};Ce.state.onToggleStatus=function(n,e){var t=n.props,a=t.id,r=t.date,o=n.state;if(e){var c=o.find((function(n){var t=en(n,1),a=t[0];return a===e}));return c?c[1]=Ne(c[1]):(c=[e,be[0]],o.push(c)),ae.update(a,r,o),[].concat(tn(o))}};var Ae=function(n){var e=n.props.id,t=n.state,a=n.bindSend;return{$s:se,a:a("decDate"),c:t.getMonth()+1,e:t.getDate()+1,g:t.getFullYear(),i:a("incDate"),k:e,l:t}},$e=function(){return new Date},Pe=function(n,e){return new Date(n.getFullYear(),n.getMonth(),n.getDate()+e)};Ae.state={onInit:$e,onProps:$e,decDate:function(n){var e=n.state;return Pe(e,-1)},incDate:function(n){var e=n.state;return Pe(e,1)}};var ke=z.createComponent,we=z.createDynamic,Se=z.el,xe=z.updateComponent,Ie=z.updateDynamic,Ee={c:function(n){var e=(n.e=ke(Qe,Qe.state,{user:n.a,page:n.b,id:n.c,tab:n.d},n)).$n;return e},u:function(n,e){n.c===e.c&&n.b===e.b&&n.a===e.a&&n.d===e.d||(e.e=xe(Qe,Qe.state,{user:e.a=n.a,page:e.b=n.b,id:e.c=n.c,tab:e.d=n.d},e.e))},r:z.DEADPOOL},Le={c:function(n){var e=ke(Be,Be.state,null,n).$n;return e},u:function(){},r:z.DEADPOOL},Te={c:function(n){var e=(n.d=ke(B,B.state,{hrefPrefix:n.a,selected:n.b,tabs:n.c},n)).$n;return e},u:function(n,e){n.b===e.b&&n.a===e.a&&n.c===e.c||(e.d=xe(B,B.state,{hrefPrefix:e.a=n.a,selected:e.b=n.b,tabs:e.c=n.c},e.d))},r:z.DEADPOOL},je={c:function(n){var e=ke(q,q.state,{className:"c-white l-padding-h4",name:"three-bars",size:"small"},n).$n;return e},u:function(){},r:z.DEADPOOL},ze={c:function(n){var e,t=Se("div");return e=(n.d=ke(gn,gn.state,{left:n.a,secondary:n.b,title:n.c},n)).$n,t.appendChild(e),n.f=we(!1,t,n.e),t},u:function(n,e){n.b===e.b&&n.a===e.a&&n.c===e.c||(e.d=xe(gn,gn.state,{left:e.a=n.a,secondary:e.b=n.b,title:e.c=n.c},e.d)),n.e!==e.e&&(e.f=Ie(!1,e.e,e.e=n.e,e.f))},r:z.DEADPOOL},Re={c:function(n){var e=(n.b=ke(Ae,Ae.state,{id:n.a},n)).$n;return e},u:function(n,e){n.a!==e.a&&(e.b=xe(Ae,Ae.state,{id:e.a=n.a},e.b))},r:z.DEADPOOL},_e={c:function(n){var e=(n.b=ke(Zn,Zn.state,{id:n.a},n)).$n;return e},u:function(n,e){n.a!==e.a&&(e.b=xe(Zn,Zn.state,{id:e.a=n.a},e.b))},r:z.DEADPOOL},Me={c:function(n){var e=(n.b=ke(Ln,Ln.state,{id:n.a},n)).$n;return e},u:function(n,e){n.a!==e.a&&(e.b=xe(Ln,Ln.state,{id:e.a=n.a},e.b))},r:z.DEADPOOL},qe={c:function(n){var e=(n.b=ke(Ke,Ke.state,{id:n.a},n)).$n;return e},u:function(n,e){n.a!==e.a&&(e.b=xe(Ke,Ke.state,{id:e.a=n.a},e.b))},r:z.DEADPOOL},Ye={c:function(n){var e,t,a=Se("div");return a.className="Card",e=Se("div"),e.className="Card-title",t=(n.c=ke(He,He.state,{id:n.a,school:n.b},n)).$n,e.appendChild(t),a.appendChild(e),a},u:function(n,e){n.a===e.a&&n.b===e.b||(e.c=xe(He,He.state,{id:e.a=n.a,school:e.b=n.b},e.c))},r:z.DEADPOOL},Ue={c:function(n){var e=Se("input");return e.className="SchoolPage-input",n.b=e,null!=n.a&&(e.value=n.a),e.oninput=n.c,e},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.value!==t&&(e.b.value=t),e.a=t),t=n.c,t!==e.c&&(e.b.oninput=t,e.c=t)},r:z.DEADPOOL},Fe={c:function(n){var e=ke(q,q.state,{className:"c-white l-padding-h4",name:"three-bars",size:"small"},n).$n;return e},u:function(){},r:z.DEADPOOL},Ge={c:function(n){var e,t=Se("div");return e=(n.b=ke(gn,gn.state,{left:n.a},n)).$n,t.appendChild(e),t},u:function(n,e){n.a!==e.a&&(e.b=xe(gn,gn.state,{left:e.a=n.a},e.b))},r:z.DEADPOOL},Je={school:{title:"School"},students:{title:"Students"},seating:{title:"Seating"},rollcall:{title:"Roll Call"}},Be=function(n){var e=n.props;e.user,e.page,e.id,e.tab;return{$s:Ge,a:{$s:Fe}}},He=function(n){var e=(n.props.id,n.state),t=n.bindSend;return{$s:Ue,a:e,c:t("updateName")}},Ve=function(n){var e=n.props;return e.school&&e.school.name};He.state={onInit:Ve,onProps:Ve,updateName:function(n,e){var t=n.props.id,a=(n.state,e.target.value);return dn.updateName(t,a),a}};var Ke=un(dn,"get",(function(n){var e=n.props.id,t=n.state;return{$s:Ye,a:e,b:t}})),We=function(n,e){return"school"===e?{$s:qe,a:n}:"students"===e?{$s:Me,a:n}:"seating"===e?{$s:_e,a:n}:"rollcall"===e?{$s:Re,a:n}:null},Qe=un(dn,"get",(function(n){var e=n.props,t=(e.user,e.page,e.id),a=e.tab,r=n.state,o=r||{};return{$s:ze,a:{$s:je},b:{$s:Te,a:"#schools/"+t+"/",b:a,c:Je},c:o.name,e:We(t,a)}})),Xe=function(n){var e=n.user,t=n.page,a=n.id,r=n.tab;return"new"===a?{$s:Le}:{$s:Ee,a:e,b:t,c:a,d:r}},Ze=z.createComponent,nt=z.createDynamic,et=z.el,tt=z.updateComponent,at=z.updateDynamic,rt={c:function(n){var e=Ze(ut,ut.state,null,n).$n;return e},u:function(){},r:z.DEADPOOL},ot={c:function(n){var e=et("body");return e.className="App",n.b=nt(!1,e,n.a),n.d=nt(!1,e,n.c),e},u:function(n,e){n.a!==e.a&&(e.b=at(!1,e.a,e.a=n.a,e.b)),n.c!==e.c&&(e.d=at(!1,e.c,e.c=n.c,e.d))},r:z.DEADPOOL},ct={c:function(n){var e=(n.e=Ze(Xe,Xe.state,{user:n.a,page:n.b,id:n.c,tab:n.d},n)).$n;return e},u:function(n,e){n.c===e.c&&n.b===e.b&&n.a===e.a&&n.d===e.d||(e.e=tt(Xe,Xe.state,{user:e.a=n.a,page:e.b=n.b,id:e.c=n.c,tab:e.d=n.d},e.e))},r:z.DEADPOOL},it={c:function(n){var e,t=et("div");return t.style.cssText="position: absolute; top: 0px; bottom: 0px; left: 0px; right: 0px;",t.className="layout horizontal center-center",e=et("a"),n.b=e,e.onclick=n.a,e.className="l-padding-4",e.style.cssText="background: #CCC; border-radius: 6px;",n.d=nt(!0,e,n.c),t.appendChild(e),t},u:function(n,e){var t;t=n.a,t!==e.a&&(e.b.onclick=t,e.a=t),n.c!==e.c&&(e.d=at(!0,e.c,e.c=n.c,e.d))},r:z.DEADPOOL},ut=function(n){var e=n.state,t=e.user,a=e.page,r=e.id,o=e.tab;return{$s:ot,a:!t&&{$s:it,a:P,c:t?"Sign out":"Sign in"},c:t&&!!a&&!!r&&{$s:ct,a:t,b:a,c:r,d:o}}},st=function(n){var e=n.state,t=window.location.hash.slice(1),a=t.split("/"),r=en(a,3),o=r[0],c=r[1],i=r[2];return nn({},e,{page:o,id:c,tab:i})};firebase.initializeApp({apiKey:"AIzaSyByU0ftUO7ECBLGGCb4awfe-u0ITxt0NVw",authDomain:"roll-call-1440c.firebaseapp.com",databaseURL:"https://roll-call-1440c.firebaseio.com",storageBucket:"roll-call-1440c.appspot.com",messagingSenderId:"115688293946"}),ut.state={onInit:function(n){var e=n.bindSend;return firebase.auth().onAuthStateChanged((function(n){return n?void cn.get(n.uid).catch((function(){return cn.save({id:n.uid,displayName:n.displayName,schools:{_init:{name:"School #1"}}})})).then((function(n){cn.setCurrent(n.id);var t=Object.keys(n.schools)[0],a=window.location.hash;a&&"#"!==a||(window.location.hash="#schools/"+t+"/school"),e("onUser")(cn.current())})):e("onUser")(n)})),window.onhashchange=e("handleHashChange"),st({user:cn.current()})},onUser:function(n,e){var t=n.state;return nn({},t,{user:e})},handleHashChange:st},document.body=z.render({$s:rt})})();

